<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - E-Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .payment-method-card {
            cursor: pointer;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .payment-method-card.selected {
            border-color: #28a745;
            background-color: #f8f9fa;
        }
        .payment-method-card i {
            font-size: 24px;
            margin-right: 10px;
        }
    </style>
</head>
<body>

<!-- Header Fragment -->
<div th:replace="fragments/footer :: header"></div>

<!-- Breadcrumb Section -->
<div class="container py-3">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/cart">Shopping Cart</a></li>
            <li class="breadcrumb-item active" aria-current="page">Checkout</li>
        </ol>
    </nav>
</div>

<!-- Checkout Section -->
<div class="container py-5">
    <div class="row">
        <!-- Checkout Information -->
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Shipping Information</h4>
                </div>
                <div class="card-body">
                    <!-- Checkout Form -->
                    <form id="checkoutForm" th:action="@{/checkout/process}" method="post">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName" class="form-label">First Name</label>
                                <input type="text" class="form-control" id="firstName" name="firstName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName" class="form-label">Last Name</label>
                                <input type="text" class="form-control" id="lastName" name="lastName" required>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="phone" name="phone" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="address" class="form-label">Address</label>
                            <input type="text" class="form-control" id="address" name="address" required>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="city" class="form-label">City</label>
                                <input type="text" class="form-control" id="city" name="city" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="state" class="form-label">State/Province</label>
                                <input type="text" class="form-control" id="state" name="state" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="zip" class="form-label">ZIP Code</label>
                                <input type="text" class="form-control" id="zip" name="zip" required>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="notes" class="form-label">Order Notes (optional)</label>
                            <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Payment Method</h4>
                </div>
                <div class="card-body">
                    <div class="payment-method-card selected" onclick="selectPaymentMethod(this, 'cash')">
                        <div class="d-flex align-items-center">
                            <input type="radio" name="paymentMethod" value="cash" checked hidden>
                            <i class="fas fa-money-bill text-success"></i>
                            <div>
                                <h5 class="mb-0">Cash on Delivery</h5>
                                <p class="mb-0 text-muted">Pay when you receive your order</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-method-card" onclick="selectPaymentMethod(this, 'credit')">
                        <div class="d-flex align-items-center">
                            <input type="radio" name="paymentMethod" value="credit" hidden>
                            <i class="fas fa-credit-card text-primary"></i>
                            <div>
                                <h5 class="mb-0">Credit/Debit Card</h5>
                                <p class="mb-0 text-muted">Visa, Mastercard, American Express</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-method-card" onclick="selectPaymentMethod(this, 'paypal')">
                        <div class="d-flex align-items-center">
                            <input type="radio" name="paymentMethod" value="paypal" hidden>
                            <i class="fab fa-paypal text-info"></i>
                            <div>
                                <h5 class="mb-0">PayPal</h5>
                                <p class="mb-0 text-muted">Pay securely with PayPal</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Order Summary -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Order Summary</h4>
                </div>
                <div class="card-body">
                    <div class="mb-4">
                        <!-- Cart Items Summary -->
                        <div th:each="item : ${cart.items}" class="d-flex justify-content-between mb-2">
                            <div>
                                <span th:text="${item.product.title}">Product Title</span>
                                <span class="text-muted">x<span th:text="${item.quantity}">1</span></span>
                            </div>
                            <span th:text="${#numbers.formatDecimal(item.subtotal, 0, 'COMMA', 2, 'POINT')} + ' VND'">$99.99</span>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Totals -->
                    <div class="d-flex justify-content-between mb-2">
                        <span>Subtotal:</span>
                        <span th:text="${#numbers.formatDecimal(cart.subtotal, 0, 'COMMA', 2, 'POINT')} + ' VND'">$199.98</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Shipping:</span>
                        <span th:text="${#numbers.formatDecimal(cart.shippingCost, 0, 'COMMA', 2, 'POINT')} + ' VND'">$10.00</span>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>VAT (10%):</span>
                        <span th:text="${#numbers.formatDecimal(cart.tax, 0, 'COMMA', 2, 'POINT')} + ' VND'">$19.99</span>
                    </div>
                    
                    <div class="d-flex justify-content-between mb-3">
                        <strong>Total:</strong>
                        <strong class="text-primary" th:text="${#numbers.formatDecimal(cart.total, 0, 'COMMA', 2, 'POINT')} + ' VND'">$229.97</strong>
                    </div>
                    
                    <!-- Place Order Button -->
                    <button type="button" class="btn btn-primary w-100" onclick="document.getElementById('checkoutForm').submit()">
                        Place Order <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                    
                    <div class="mt-3">
                        <small class="text-muted">
                            By placing your order, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.
                        </small>
                    </div>
                </div>
            </div>
            
            <!-- Secure Checkout Info -->
            <div class="mt-3">
                <div class="card">
                    <div class="card-body">
                        <div class="mb-3 text-center">
                            <i class="fas fa-lock text-success me-2"></i>
                            <span>Secure Checkout</span>
                        </div>
                        <div class="d-flex justify-content-center">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/200px-Visa_Inc._logo.svg.png" alt="Visa" height="30" class="me-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Mastercard_2019_logo.svg/200px-Mastercard_2019_logo.svg.png" alt="Mastercard" height="30" class="me-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/American_Express_logo_%282018%29.svg/200px-American_Express_logo_%282018%29.svg.png" alt="Amex" height="30" class="me-2">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/200px-PayPal.svg.png" alt="PayPal" height="30">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer Fragment -->
<div th:replace="fragments/footer :: footer"></div>

<!-- Bootstrap and JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function selectPaymentMethod(element, method) {
        // Remove selected class from all payment methods
        document.querySelectorAll('.payment-method-card').forEach(card => {
            card.classList.remove('selected');
        });
        
        // Add selected class to chosen payment method
        element.classList.add('selected');
        
        // Check the radio button
        document.querySelector(`input[value="${method}"]`).checked = true;
        
        // Add payment method to form
        const paymentMethodInput = document.getElementById('paymentMethod');
        if (!paymentMethodInput) {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.id = 'paymentMethod';
            input.name = 'paymentMethod';
            input.value = method;
            document.getElementById('checkoutForm').appendChild(input);
        } else {
            paymentMethodInput.value = method;
        }
    }
</script>

</body>
</html>